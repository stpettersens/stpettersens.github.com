(function(){var p=function(t,s){s=s.split("u").join("");this.r=new RegExp(t,s)};p.__name__=true;p.prototype={replace:function(t,u){return t.replace(this.r,u)},__class__:p};var c=function(){};c.__name__=true;c.displayVersion=function(){l.println("hackedGaudi v. "+c.appVersion+l.getPlatform())};c.displayError=function(s){l.println("Error: "+s+".");c.displayUsage(c.errorCode)};c.displayUsage=function(t){var s='\nhackedGaudi platform agnostic build tool\nCopyright (c) 2013 Sam Saint-Pettersen\n\nReleased under the MIT/X11 License.\n\nUsage: hgaudi [-l][-u][-i][-v][-b][-m][-q]\n[-f &lt;build file&gt;][-u &lt;build file URL&gt;][&lt;action&gt;|"&lt;command&gt;"]\n\n-l: Enable logging of certain events.\n-i: Display usage information and quit.\n-v: Display version information and quit.\n-b: Generate a Gaudi build file (build.json).\n-q: Mute console output, except for :echo and errors &lt;Quiet mode&gt;.\n-f: Use &lt;build file&gt; instead of build.json.\n-u: Use &lt;build file URL&gt; instead of local file.';l.println(s)};c.loadBuild=function(u){var w=null;var t=new XMLHttpRequest();t.open("GET",c.buildFile,false);t.send();if(t.status==200){w=t.responseText}else{c.displayError("Build file ("+c.buildFile+") cannot be loaded")}w=r.replace(w,"\t","");var v=new j(w,u);var s=new g(u);s.setTarget(v.getTarget());s.setAction(v.getAction());s.doAction()};c.main=function(){c.buildFile="build.json";var t="build";var s=function(){l.instruct("To begin, upload your source files to build");l.instruct("and your build file (e.g. build.json) in the Files tab.");c.displayUsage(c.cleanCode)};new $(function(){var u=false;s();new $("#enterCommand").click(function(w){l.cls();var v=new $("#command").val();var x=v.split(" ");l.clear();console.log(x);if(x[1]=="-f"){c.buildFile=x[2];u=true;if(x[3]!=null){t=x[3]}l.cls();c.loadBuild(t)}else{if(x[1].charAt(0)=="-"){if(x[1]=="-v"){c.displayVersion()}else{if(x[1]=="-i"){c.displayUsage(c.cleanCode)}}}else{if(u&&x[1]!=""){c.loadBuild(x[1])}else{if(x[1]==""){c.displayError("No build file or action provided")}}}}})})};var g=function(s){this.action_name=s;this.passed=false;this.verbose=true};g.__name__=true;g.prototype={doAction:function(){l.println("[ "+this.target+" => "+this.action_name+" ]");var u=this.action.keys();while(u.hasNext()){var v=u.next();var t=this.doCommand(v,this.action.get(v));if(t==0){this.passed=true}else{this.passed=false}}var s="failed";if(this.passed){s="completed successfully"}l.println("\nAction "+s+".")},doCommand:function(u,t){this.printCommand(u,t);var s=0;switch(u){case"null":break;case"exec":s=this.execExtern(t);break;case"erase":break}return s},setAction:function(s){this.action=s},setTarget:function(s){this.target=s},execExtern:function(u){var s=u.split(" ");var t=s.slice(2,s.length-1);return 0},printCommand:function(t,s){if(this.verbose&&t!="echo"&&t!="null"){l.println("\t:"+t+" "+s)}else{if(t=="echo"){l.println("\t#"+s)}}},__class__:g};var j=function(t,s){this.buildConf=t;this.action_name=s;this.parseBuildJSON()};j.__name__=true;j.prototype={getAction:function(){return this.action},getTarget:function(){return this.preamble.get("target")},parseBuildJSON:function(){this.preamble=new q.ds.StringMap();var H=null;try{H=q.Json.parse(this.buildConf)}catch(u){if(i.Boot.__instanceof(u,String)){c.displayError("Badly formatted JSON in build file")}else{throw (u)}}var v=0,B=a.fields(H.preamble);while(v<B.length){var G=B[v];++v;var s=a.field(H.preamble,G);this.preamble.set(d.string(G),d.string(s))}var t=q.Json.parse(this.buildConf);var F=new q.ds.StringMap();var E=null;this.action=new q.ds.StringMap();var v=this;switch(v.action_name){case"build":var B=0,w=a.fields(t.build);while(B<w.length){var G=w[B];++B;E=a.field(t.build,G);F.set(d.string(G),d.string(E));var C=F.get(G);C=r.replace(C,"[","");C=r.replace(C,"{","");C=r.replace(C,"}","");C=r.replace(C,"\n","");var A=C.split(":");var D=new p("(\\W+)","g");A[0]=D.replace(A[0],"");this.action.set(A[0],A[1]);console.log(this.action)}break;case"clean":var B=0,w=a.fields(t.clean);while(B<w.length){var G=w[B];++B;E=a.field(t.clean,G);F.set(d.string(G),d.string(E));var C=F.get(G);C=r.replace(C,"[","");C=r.replace(C,"{","");C=r.replace(C,"}","");C=r.replace(C,"\n","");var A=C.split(":");var D=new p("(\\W+)","g");A[0]=D.replace(A[0],"");this.action.set(A[0],A[1]);console.log(this.action)}break}},__class__:j};var l=function(){};l.__name__=true;l.println=function(s){new $(function(){new $("#console").append(s+"<br/>")})};l.instruct=function(s){new $(function(){new $("#console").append("<strong>"+s+"</strong><br/>")})};l.cls=function(){new $(function(){new $("#console").empty()})};l.clear=function(){new $(function(){new $("#command").val("");new $("#command").val("hgaudi ");new $("#command").focus()})};l.getPlatform=function(){var s=null;s="JavaScript [";if($.browser.webkit){s+="WebKit-based/"+$.browser.version}else{if($.browser.opera){s+="Opera/"+$.browser.version}else{if($.browser.msie){s+="MSIE/"+$.browser.version}else{if($.browser.mozilla){s+="Firefox/"+$.browser.version}}}}s+="]";return" ("+s+")"};var f=function(){};f.__name__=true;f.cca=function(v,u){var t=v.charCodeAt(u);if(t!=t){return undefined}return t};f.substr=function(u,v,t){if(v!=null&&v!=0&&t!=null&&t<0){return""}if(t==null){t=u.length}if(v<0){v=u.length+v;if(v<0){v=0}}else{if(t<0){t=u.length+t-v}}return u.substr(v,t)};f.iter=function(s){return{cur:0,arr:s,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var a=function(){};a.__name__=true;a.field=function(w,u){var s=null;try{s=w[u]}catch(t){}return s};a.fields=function(v){var s=[];if(v!=null){var u=Object.prototype.hasOwnProperty;for(var t in v){if(t!="__id__"&&u.call(v,t)){s.push(t)}}}return s};var d=function(){};d.__name__=true;d.string=function(t){return i.Boot.__string_rec(t,"")};d.parseInt=function(s){var t=parseInt(s,10);if(t==0&&(f.cca(s,1)==120||f.cca(s,1)==88)){t=parseInt(s)}if(isNaN(t)){return null}return t};d.parseFloat=function(s){return parseFloat(s)};var m=function(){this.b=""};m.__name__=true;m.prototype={addSub:function(u,v,t){this.b+=t==null?f.substr(u,v,null):f.substr(u,v,t)},__class__:m};var r=function(){};r.__name__=true;r.replace=function(u,t,v){return u.split(t).join(v)};var q={};q.Json=function(){};q.Json.__name__=true;q.Json.parse=function(s){return new q.Json().doParse(s)};q.Json.prototype={parseNumber:function(A){var s=this.pos-1;var v=A==45,B=!v,z=A==48;var C=false,y=false,t=false,u=false;while(true){A=this.str.charCodeAt(this.pos++);switch(A){case 48:if(z&&!C){this.invalidNumber(s)}if(v){v=false;z=true}B=true;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(z&&!C){this.invalidNumber(s)}if(v){v=false}B=true;z=false;break;case 46:if(v||C){this.invalidNumber(s)}B=false;C=true;break;case 101:case 69:if(v||z||y){this.invalidNumber(s)}B=false;y=true;break;case 43:case 45:if(!y||t){this.invalidNumber(s)}B=false;t=true;break;default:if(!B){this.invalidNumber(s)}this.pos--;u=true}if(u){break}}var x=d.parseFloat(f.substr(this.str,s,this.pos-s));var w=x|0;return w==x?w:x},invalidNumber:function(s){throw"Invalid number at position "+s+": "+f.substr(this.str,s,this.pos-s)},parseString:function(){var v=this.pos;var t=new m();while(true){var u=this.str.charCodeAt(this.pos++);if(u==34){break}if(u==92){t.addSub(this.str,v,this.pos-v-1);u=this.str.charCodeAt(this.pos++);switch(u){case 114:t.b+="\r";break;case 110:t.b+="\n";break;case 116:t.b+="\t";break;case 98:t.b+="";break;case 102:t.b+="";break;case 47:case 92:case 34:t.b+=String.fromCharCode(u);break;case 117:var s=d.parseInt("0x"+f.substr(this.str,this.pos,4));this.pos+=4;t.b+=String.fromCharCode(s);break;default:throw"Invalid escape sequence \\"+String.fromCharCode(u)+" at position "+(this.pos-1)}v=this.pos}else{if(u!=u){throw"Unclosed string"}}}t.addSub(this.str,v,this.pos-v-1);return t.b},parseRec:function(){while(true){var y=this.str.charCodeAt(this.pos++);switch(y){case 32:case 13:case 10:case 9:break;case 123:var x={},w=null,t=null;while(true){var u=this.str.charCodeAt(this.pos++);switch(u){case 32:case 13:case 10:case 9:break;case 125:if(w!=null||t==false){this.invalidChar()}return x;case 58:if(w==null){this.invalidChar()}x[w]=this.parseRec();w=null;t=true;break;case 44:if(t){t=false}else{this.invalidChar()}break;case 34:if(t){this.invalidChar()}w=this.parseString();break;default:this.invalidChar()}}break;case 91:var s=[],t=null;while(true){var u=this.str.charCodeAt(this.pos++);switch(u){case 32:case 13:case 10:case 9:break;case 93:if(t==false){this.invalidChar()}return s;case 44:if(t){t=false}else{this.invalidChar()}break;default:if(t){this.invalidChar()}this.pos--;s.push(this.parseRec());t=true}}break;case 116:var v=this.pos;if(this.str.charCodeAt(this.pos++)!=114||this.str.charCodeAt(this.pos++)!=117||this.str.charCodeAt(this.pos++)!=101){this.pos=v;this.invalidChar()}return true;case 102:var v=this.pos;if(this.str.charCodeAt(this.pos++)!=97||this.str.charCodeAt(this.pos++)!=108||this.str.charCodeAt(this.pos++)!=115||this.str.charCodeAt(this.pos++)!=101){this.pos=v;this.invalidChar()}return false;case 110:var v=this.pos;if(this.str.charCodeAt(this.pos++)!=117||this.str.charCodeAt(this.pos++)!=108||this.str.charCodeAt(this.pos++)!=108){this.pos=v;this.invalidChar()}return null;case 34:return this.parseString();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 45:return this.parseNumber(y);default:this.invalidChar()}}},invalidChar:function(){this.pos--;throw"Invalid char "+this.str.charCodeAt(this.pos)+" at position "+this.pos},doParse:function(s){this.str=s;this.pos=0;return this.parseRec()},__class__:q.Json};q.ds={};q.ds.StringMap=function(){this.h={}};q.ds.StringMap.__name__=true;q.ds.StringMap.prototype={keys:function(){var s=[];for(var t in this.h){if(this.h.hasOwnProperty(t)){s.push(t.substr(1))}}return f.iter(s)},get:function(s){return this.h["$"+s]},set:function(s,t){this.h["$"+s]=t},__class__:q.ds.StringMap};var i={};i.Boot=function(){};i.Boot.__name__=true;i.Boot.__string_rec=function(v,H){if(v==null){return"null"}if(H.length>=5){return"<...>"}var G=typeof(v);if(G=="function"&&(v.__name__||v.__ename__)){G="object"}switch(G){case"object":if(v instanceof Array){if(v.__enum__){if(v.length==2){return v[0]}var D=v[0]+"(";H+="\t";var E=2,A=v.length;while(E<A){var z=E++;if(z!=2){D+=","+i.Boot.__string_rec(v[z],H)}else{D+=i.Boot.__string_rec(v[z],H)}}return D+")"}var w=v.length;var z;var D="[";H+="\t";var A=0;while(A<w){var y=A++;D+=(y>0?",":"")+i.Boot.__string_rec(v[y],H)}D+="]";return D}var C;try{C=v.toString}catch(B){return"???"}if(C!=null&&C!=Object.toString){var F=v.toString();if(F!="[object Object]"){return F}}var x=null;var D="{\n";H+="\t";var u=v.hasOwnProperty!=null;for(var x in v){if(u&&!v.hasOwnProperty(x)){continue}if(x=="prototype"||x=="__class__"||x=="__super__"||x=="__interfaces__"||x=="__properties__"){continue}if(D.length!=2){D+=", \n"}D+=H+x+" : "+i.Boot.__string_rec(v[x],H)}H=H.substring(1);D+="\n"+H+"}";return D;case"function":return"<function>";case"string":return v;default:return String(v)}};i.Boot.__interfLoop=function(y,t){if(y==null){return false}if(y==t){return true}var s=y.__interfaces__;if(s!=null){var w=0,x=s.length;while(w<x){var u=w++;var v=s[u];if(v==t||i.Boot.__interfLoop(v,t)){return true}}}return i.Boot.__interfLoop(y.__super__,t)};i.Boot.__instanceof=function(u,s){try{if(u instanceof s){if(s==Array){return u.__enum__==null}return true}if(i.Boot.__interfLoop(u.__class__,s)){return true}}catch(t){if(s==null){return false}}switch(s){case e:return Math.ceil(u%2147483648)===u;case b:return typeof(u)=="number";case k:return u===true||u===false;case String:return typeof(u)=="string";case n:return true;default:if(u==null){return false}if(s==o&&u.__name__!=null){return true}else{null}if(s==h&&u.__ename__!=null){return true}else{null}return u.__enum__==s}};String.prototype.__class__=String;String.__name__=true;Array.prototype.__class__=Array;Array.__name__=true;var e={__name__:["Int"]};var n={__name__:["Dynamic"]};var b=Number;b.__name__=["Float"];var k=Boolean;k.__ename__=["Bool"];var o={__name__:["Class"]};var h={};if(typeof(JSON)!="undefined"){q.Json=JSON}c.appVersion="0.1";c.buildFile="build.json";c.errorCode=-1;c.cleanCode=0;c.main()})();